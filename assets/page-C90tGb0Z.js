import{j as p,c as q,f as te,P as Re}from"./pro-components-DqS1vNmp.js";import{u as Ce}from"./index-BkSZUkhJ.js";import{r as K,i as $,aN as ne,a5 as ge,S as _,Z as ee,ae as Ue,aK as xe,B as Be}from"./antd-2qrym3SB.js";import{I as Fe}from"./index-d_YuH_AW.js";import{C as me}from"./ContentCopyButton-BjXZ8JlH.js";import{i as Ke,_ as je}from"./index-Zzt7kOGj.js";import"./jsoneditor-EB9WOjbk.js";function Me(n){var e=K.useRef(n);return e.current=n,e}var Z=function(n){if(!n)return 0;var e=$(n).valueOf()-Date.now();return e<0?0:e},Te=function(n){return{days:Math.floor(n/864e5),hours:Math.floor(n/36e5)%24,minutes:Math.floor(n/6e4)%60,seconds:Math.floor(n/1e3)%60,milliseconds:Math.floor(n)%1e3}},ke=function(n){n===void 0&&(n={});var e=n||{},r=e.leftTime,t=e.targetDate,s=e.interval,i=s===void 0?1e3:s,u=e.onEnd,c=K.useMemo(function(){return"leftTime"in n?Ke(r)&&r>0?Date.now()+r:void 0:t},[r,t]),a=je(K.useState(function(){return Z(c)}),2),l=a[0],d=a[1],h=Me(u);K.useEffect(function(){if(!c){d(0);return}d(Z(c));var m=setInterval(function(){var g,A=Z(c);d(A),A===0&&(clearInterval(m),(g=h.current)===null||g===void 0||g.call(h))},i);return function(){return clearInterval(m)}},[c,i]);var f=K.useMemo(function(){return Te(l)},[l]);return[l,f]};const Ye=n=>{const e=new ArrayBuffer(8),r=new Uint8Array(e);let t=n;for(let s=7;s>=0&&t!==0;s--)r[s]=t&255,t-=r[s],t/=256;return e},Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pe="ARRAYBUFFER not supported by this environment",be="UINT8ARRAY not supported by this environment";function re(n,e,r,t){let s,i,u;const c=e||[0],a=(r=r||0)>>>3,l=t===-1?3:0;for(s=0;s<n.length;s+=1)u=s+a,i=u>>>2,c.length<=i&&c.push(0),c[i]|=n[s]<<8*(l+t*(u%4));return{value:c,binLen:8*n.length+r}}function k(n,e,r){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(n){case"HEX":return function(t,s,i){return function(u,c,a,l){let d,h,f,m;if(u.length%2!=0)throw new Error("String of HEX type must be in byte increments");const g=c||[0],A=(a=a||0)>>>3,b=l===-1?3:0;for(d=0;d<u.length;d+=2){if(h=parseInt(u.substr(d,2),16),isNaN(h))throw new Error("String of HEX type contains invalid characters");for(m=(d>>>1)+A,f=m>>>2;g.length<=f;)g.push(0);g[f]|=h<<8*(b+l*(m%4))}return{value:g,binLen:4*u.length+a}}(t,s,i,r)};case"TEXT":return function(t,s,i){return function(u,c,a,l,d){let h,f,m,g,A,b,y,I,L=0;const E=a||[0],H=(l=l||0)>>>3;if(c==="UTF8")for(y=d===-1?3:0,m=0;m<u.length;m+=1)for(h=u.charCodeAt(m),f=[],128>h?f.push(h):2048>h?(f.push(192|h>>>6),f.push(128|63&h)):55296>h||57344<=h?f.push(224|h>>>12,128|h>>>6&63,128|63&h):(m+=1,h=65536+((1023&h)<<10|1023&u.charCodeAt(m)),f.push(240|h>>>18,128|h>>>12&63,128|h>>>6&63,128|63&h)),g=0;g<f.length;g+=1){for(b=L+H,A=b>>>2;E.length<=A;)E.push(0);E[A]|=f[g]<<8*(y+d*(b%4)),L+=1}else for(y=d===-1?2:0,I=c==="UTF16LE"&&d!==1||c!=="UTF16LE"&&d===1,m=0;m<u.length;m+=1){for(h=u.charCodeAt(m),I===!0&&(g=255&h,h=g<<8|h>>>8),b=L+H,A=b>>>2;E.length<=A;)E.push(0);E[A]|=h<<8*(y+d*(b%4)),L+=2}return{value:E,binLen:8*L+l}}(t,e,s,i,r)};case"B64":return function(t,s,i){return function(u,c,a,l){let d,h,f,m,g,A,b,y=0;const I=c||[0],L=(a=a||0)>>>3,E=l===-1?3:0,H=u.indexOf("=");if(u.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(u=u.replace(/=/g,""),H!==-1&&H<u.length)throw new Error("Invalid '=' found in base-64 string");for(h=0;h<u.length;h+=4){for(g=u.substr(h,4),m=0,f=0;f<g.length;f+=1)d=Ae.indexOf(g.charAt(f)),m|=d<<18-6*f;for(f=0;f<g.length-1;f+=1){for(b=y+L,A=b>>>2;I.length<=A;)I.push(0);I[A]|=(m>>>16-8*f&255)<<8*(E+l*(b%4)),y+=1}}return{value:I,binLen:8*y+a}}(t,s,i,r)};case"BYTES":return function(t,s,i){return function(u,c,a,l){let d,h,f,m;const g=c||[0],A=(a=a||0)>>>3,b=l===-1?3:0;for(h=0;h<u.length;h+=1)d=u.charCodeAt(h),m=h+A,f=m>>>2,g.length<=f&&g.push(0),g[f]|=d<<8*(b+l*(m%4));return{value:g,binLen:8*u.length+a}}(t,s,i,r)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(pe)}return function(t,s,i){return function(u,c,a,l){return re(new Uint8Array(u),c,a,l)}(t,s,i,r)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(be)}return function(t,s,i){return re(t,s,i,r)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function se(n,e,r,t){switch(n){case"HEX":return function(s){return function(i,u,c,a){const l="0123456789abcdef";let d,h,f="";const m=u/8,g=c===-1?3:0;for(d=0;d<m;d+=1)h=i[d>>>2]>>>8*(g+c*(d%4)),f+=l.charAt(h>>>4&15)+l.charAt(15&h);return a.outputUpper?f.toUpperCase():f}(s,e,r,t)};case"B64":return function(s){return function(i,u,c,a){let l,d,h,f,m,g="";const A=u/8,b=c===-1?3:0;for(l=0;l<A;l+=3)for(f=l+1<A?i[l+1>>>2]:0,m=l+2<A?i[l+2>>>2]:0,h=(i[l>>>2]>>>8*(b+c*(l%4))&255)<<16|(f>>>8*(b+c*((l+1)%4))&255)<<8|m>>>8*(b+c*((l+2)%4))&255,d=0;d<4;d+=1)g+=8*l+6*d<=u?Ae.charAt(h>>>6*(3-d)&63):a.b64Pad;return g}(s,e,r,t)};case"BYTES":return function(s){return function(i,u,c){let a,l,d="";const h=u/8,f=c===-1?3:0;for(a=0;a<h;a+=1)l=i[a>>>2]>>>8*(f+c*(a%4))&255,d+=String.fromCharCode(l);return d}(s,e,r)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch{throw new Error(pe)}return function(s){return function(i,u,c){let a;const l=u/8,d=new ArrayBuffer(l),h=new Uint8Array(d),f=c===-1?3:0;for(a=0;a<l;a+=1)h[a]=i[a>>>2]>>>8*(f+c*(a%4))&255;return d}(s,e,r)};case"UINT8ARRAY":try{new Uint8Array(0)}catch{throw new Error(be)}return function(s){return function(i,u,c){let a;const l=u/8,d=c===-1?3:0,h=new Uint8Array(l);for(a=0;a<l;a+=1)h[a]=i[a>>>2]>>>8*(d+c*(a%4))&255;return h}(s,e,r)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const P=4294967296,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],B=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],F=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],X="Chosen SHA variant is not supported",Ie="Cannot set numRounds with MAC";function V(n,e){let r,t;const s=n.binLen>>>3,i=e.binLen>>>3,u=s<<3,c=4-s<<3;if(s%4!=0){for(r=0;r<i;r+=4)t=s+r>>>2,n.value[t]|=e.value[r>>>2]<<u,n.value.push(0),n.value[t+1]|=e.value[r>>>2]>>>c;return(n.value.length<<2)-4>=i+s&&n.value.pop(),{value:n.value,binLen:n.binLen+e.binLen}}return{value:n.value.concat(e.value),binLen:n.binLen+e.binLen}}function ie(n){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},r=n||{},t="Output length must be a multiple of 8";if(e.outputUpper=r.outputUpper||!1,r.b64Pad&&(e.b64Pad=r.b64Pad),r.outputLen){if(r.outputLen%8!=0)throw new Error(t);e.outputLen=r.outputLen}else if(r.shakeLen){if(r.shakeLen%8!=0)throw new Error(t);e.outputLen=r.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function j(n,e,r,t){const s=n+" must include a value and format";if(!e){if(!t)throw new Error(s);return t}if(e.value===void 0||!e.format)throw new Error(s);return k(e.format,e.encoding||"UTF8",r)(e.value)}class G{constructor(e,r,t){const s=t||{};if(this.t=r,this.i=s.encoding||"UTF8",this.numRounds=s.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let r,t=0;const s=this.m>>>5,i=this.C(e,this.h,this.u),u=i.binLen,c=i.value,a=u>>>5;for(r=0;r<a;r+=s)t+this.m<=u&&(this.U=this.v(c.slice(r,r+s),this.U),t+=this.m);return this.A+=t,this.h=c.slice(t>>>5),this.u=u%this.m,this.l=!0,this}getHash(e,r){let t,s,i=this.R;const u=ie(r);if(this.K){if(u.outputLen===-1)throw new Error("Output length must be specified in options");i=u.outputLen}const c=se(e,i,this.T,u);if(this.H&&this.g)return c(this.g(u));for(s=this.F(this.h.slice(),this.u,this.A,this.L(this.U),i),t=1;t<this.numRounds;t+=1)this.K&&i%32!=0&&(s[s.length-1]&=16777215>>>24-i%32),s=this.F(s,i,0,this.B(this.o),i);return c(s)}setHMACKey(e,r,t){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const s=k(r,(t||{}).encoding||"UTF8",this.T);this.k(s(e))}k(e){const r=this.m>>>3,t=r/4-1;let s;if(this.numRounds!==1)throw new Error(Ie);if(this.H)throw new Error("MAC key already set");for(r<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=t;)e.value.push(0);for(s=0;s<=t;s+=1)this.S[s]=909522486^e.value[s],this.p[s]=1549556828^e.value[s];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,r){const t=ie(r);return se(e,this.R,this.T,t)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const r=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(r,this.R,this.m,e,this.R),e}}function M(n,e){return n<<e|n>>>32-e}function U(n,e){return n>>>e|n<<32-e}function ve(n,e){return n>>>e}function oe(n,e,r){return n^e^r}function Ne(n,e,r){return n&e^~n&r}function ye(n,e,r){return n&e^n&r^e&r}function $e(n){return U(n,2)^U(n,13)^U(n,22)}function N(n,e){const r=(65535&n)+(65535&e);return(65535&(n>>>16)+(e>>>16)+(r>>>16))<<16|65535&r}function De(n,e,r,t){const s=(65535&n)+(65535&e)+(65535&r)+(65535&t);return(65535&(n>>>16)+(e>>>16)+(r>>>16)+(t>>>16)+(s>>>16))<<16|65535&s}function D(n,e,r,t,s){const i=(65535&n)+(65535&e)+(65535&r)+(65535&t)+(65535&s);return(65535&(n>>>16)+(e>>>16)+(r>>>16)+(t>>>16)+(s>>>16)+(i>>>16))<<16|65535&i}function Pe(n){return U(n,7)^U(n,18)^ve(n,3)}function Xe(n){return U(n,6)^U(n,11)^U(n,25)}function ze(n){return[1732584193,4023233417,2562383102,271733878,3285377520]}function Ee(n,e){let r,t,s,i,u,c,a;const l=[];for(r=e[0],t=e[1],s=e[2],i=e[3],u=e[4],a=0;a<80;a+=1)l[a]=a<16?n[a]:M(l[a-3]^l[a-8]^l[a-14]^l[a-16],1),c=a<20?D(M(r,5),Ne(t,s,i),u,1518500249,l[a]):a<40?D(M(r,5),oe(t,s,i),u,1859775393,l[a]):a<60?D(M(r,5),ye(t,s,i),u,2400959708,l[a]):D(M(r,5),oe(t,s,i),u,3395469782,l[a]),u=i,i=s,s=M(t,30),t=r,r=c;return e[0]=N(r,e[0]),e[1]=N(t,e[1]),e[2]=N(s,e[2]),e[3]=N(i,e[3]),e[4]=N(u,e[4]),e}function Oe(n,e,r,t){let s;const i=15+(e+65>>>9<<4),u=e+r;for(;n.length<=i;)n.push(0);for(n[e>>>5]|=128<<24-e%32,n[i]=4294967295&u,n[i-1]=u/P|0,s=0;s<n.length;s+=16)t=Ee(n.slice(s,s+16),t);return t}let Ve=class extends G{constructor(n,e,r){if(n!=="SHA-1")throw new Error(X);super(n,e,r);const t=r||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=k(this.t,this.i,this.T),this.v=Ee,this.L=function(s){return s.slice()},this.B=ze,this.F=Oe,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,t.hmacKey&&this.k(j("hmacKey",t.hmacKey,this.T))}};function ue(n){let e;return e=n=="SHA-224"?B.slice():F.slice(),e}function he(n,e){let r,t,s,i,u,c,a,l,d,h,f;const m=[];for(r=e[0],t=e[1],s=e[2],i=e[3],u=e[4],c=e[5],a=e[6],l=e[7],f=0;f<64;f+=1)m[f]=f<16?n[f]:De(U(g=m[f-2],17)^U(g,19)^ve(g,10),m[f-7],Pe(m[f-15]),m[f-16]),d=D(l,Xe(u),Ne(u,c,a),w[f],m[f]),h=N($e(r),ye(r,t,s)),l=a,a=c,c=u,u=N(i,d),i=s,s=t,t=r,r=N(d,h);var g;return e[0]=N(r,e[0]),e[1]=N(t,e[1]),e[2]=N(s,e[2]),e[3]=N(i,e[3]),e[4]=N(u,e[4]),e[5]=N(c,e[5]),e[6]=N(a,e[6]),e[7]=N(l,e[7]),e}let Ge=class extends G{constructor(n,e,r){if(n!=="SHA-224"&&n!=="SHA-256")throw new Error(X);super(n,e,r);const t=r||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=k(this.t,this.i,this.T),this.v=he,this.L=function(s){return s.slice()},this.B=ue,this.F=function(s,i,u,c){return function(a,l,d,h,f){let m,g;const A=15+(l+65>>>9<<4),b=l+d;for(;a.length<=A;)a.push(0);for(a[l>>>5]|=128<<24-l%32,a[A]=4294967295&b,a[A-1]=b/P|0,m=0;m<a.length;m+=16)h=he(a.slice(m,m+16),h);return g=f==="SHA-224"?[h[0],h[1],h[2],h[3],h[4],h[5],h[6]]:h,g}(s,i,u,c,n)},this.U=ue(n),this.m=512,this.R=n==="SHA-224"?224:256,this.K=!1,t.hmacKey&&this.k(j("hmacKey",t.hmacKey,this.T))}};class o{constructor(e,r){this.N=e,this.I=r}}function ae(n,e){let r;return e>32?(r=64-e,new o(n.I<<e|n.N>>>r,n.N<<e|n.I>>>r)):e!==0?(r=32-e,new o(n.N<<e|n.I>>>r,n.I<<e|n.N>>>r)):n}function x(n,e){let r;return e<32?(r=32-e,new o(n.N>>>e|n.I<<r,n.I>>>e|n.N<<r)):(r=64-e,new o(n.I>>>e|n.N<<r,n.N>>>e|n.I<<r))}function Se(n,e){return new o(n.N>>>e,n.I>>>e|n.N<<32-e)}function qe(n,e,r){return new o(n.N&e.N^n.N&r.N^e.N&r.N,n.I&e.I^n.I&r.I^e.I&r.I)}function Ze(n){const e=x(n,28),r=x(n,34),t=x(n,39);return new o(e.N^r.N^t.N,e.I^r.I^t.I)}function R(n,e){let r,t;r=(65535&n.I)+(65535&e.I),t=(n.I>>>16)+(e.I>>>16)+(r>>>16);const s=(65535&t)<<16|65535&r;return r=(65535&n.N)+(65535&e.N)+(t>>>16),t=(n.N>>>16)+(e.N>>>16)+(r>>>16),new o((65535&t)<<16|65535&r,s)}function Je(n,e,r,t){let s,i;s=(65535&n.I)+(65535&e.I)+(65535&r.I)+(65535&t.I),i=(n.I>>>16)+(e.I>>>16)+(r.I>>>16)+(t.I>>>16)+(s>>>16);const u=(65535&i)<<16|65535&s;return s=(65535&n.N)+(65535&e.N)+(65535&r.N)+(65535&t.N)+(i>>>16),i=(n.N>>>16)+(e.N>>>16)+(r.N>>>16)+(t.N>>>16)+(s>>>16),new o((65535&i)<<16|65535&s,u)}function Qe(n,e,r,t,s){let i,u;i=(65535&n.I)+(65535&e.I)+(65535&r.I)+(65535&t.I)+(65535&s.I),u=(n.I>>>16)+(e.I>>>16)+(r.I>>>16)+(t.I>>>16)+(s.I>>>16)+(i>>>16);const c=(65535&u)<<16|65535&i;return i=(65535&n.N)+(65535&e.N)+(65535&r.N)+(65535&t.N)+(65535&s.N)+(u>>>16),u=(n.N>>>16)+(e.N>>>16)+(r.N>>>16)+(t.N>>>16)+(s.N>>>16)+(i>>>16),new o((65535&u)<<16|65535&i,c)}function Y(n,e){return new o(n.N^e.N,n.I^e.I)}function We(n){const e=x(n,19),r=x(n,61),t=Se(n,6);return new o(e.N^r.N^t.N,e.I^r.I^t.I)}function _e(n){const e=x(n,1),r=x(n,8),t=Se(n,7);return new o(e.N^r.N^t.N,e.I^r.I^t.I)}function et(n){const e=x(n,14),r=x(n,18),t=x(n,41);return new o(e.N^r.N^t.N,e.I^r.I^t.I)}const tt=[new o(w[0],3609767458),new o(w[1],602891725),new o(w[2],3964484399),new o(w[3],2173295548),new o(w[4],4081628472),new o(w[5],3053834265),new o(w[6],2937671579),new o(w[7],3664609560),new o(w[8],2734883394),new o(w[9],1164996542),new o(w[10],1323610764),new o(w[11],3590304994),new o(w[12],4068182383),new o(w[13],991336113),new o(w[14],633803317),new o(w[15],3479774868),new o(w[16],2666613458),new o(w[17],944711139),new o(w[18],2341262773),new o(w[19],2007800933),new o(w[20],1495990901),new o(w[21],1856431235),new o(w[22],3175218132),new o(w[23],2198950837),new o(w[24],3999719339),new o(w[25],766784016),new o(w[26],2566594879),new o(w[27],3203337956),new o(w[28],1034457026),new o(w[29],2466948901),new o(w[30],3758326383),new o(w[31],168717936),new o(w[32],1188179964),new o(w[33],1546045734),new o(w[34],1522805485),new o(w[35],2643833823),new o(w[36],2343527390),new o(w[37],1014477480),new o(w[38],1206759142),new o(w[39],344077627),new o(w[40],1290863460),new o(w[41],3158454273),new o(w[42],3505952657),new o(w[43],106217008),new o(w[44],3606008344),new o(w[45],1432725776),new o(w[46],1467031594),new o(w[47],851169720),new o(w[48],3100823752),new o(w[49],1363258195),new o(w[50],3750685593),new o(w[51],3785050280),new o(w[52],3318307427),new o(w[53],3812723403),new o(w[54],2003034995),new o(w[55],3602036899),new o(w[56],1575990012),new o(w[57],1125592928),new o(w[58],2716904306),new o(w[59],442776044),new o(w[60],593698344),new o(w[61],3733110249),new o(w[62],2999351573),new o(w[63],3815920427),new o(3391569614,3928383900),new o(3515267271,566280711),new o(3940187606,3454069534),new o(4118630271,4000239992),new o(116418474,1914138554),new o(174292421,2731055270),new o(289380356,3203993006),new o(460393269,320620315),new o(685471733,587496836),new o(852142971,1086792851),new o(1017036298,365543100),new o(1126000580,2618297676),new o(1288033470,3409855158),new o(1501505948,4234509866),new o(1607167915,987167468),new o(1816402316,1246189591)];function ce(n){return n==="SHA-384"?[new o(3418070365,B[0]),new o(1654270250,B[1]),new o(2438529370,B[2]),new o(355462360,B[3]),new o(1731405415,B[4]),new o(41048885895,B[5]),new o(3675008525,B[6]),new o(1203062813,B[7])]:[new o(F[0],4089235720),new o(F[1],2227873595),new o(F[2],4271175723),new o(F[3],1595750129),new o(F[4],2917565137),new o(F[5],725511199),new o(F[6],4215389547),new o(F[7],327033209)]}function le(n,e){let r,t,s,i,u,c,a,l,d,h,f,m;const g=[];for(r=e[0],t=e[1],s=e[2],i=e[3],u=e[4],c=e[5],a=e[6],l=e[7],f=0;f<80;f+=1)f<16?(m=2*f,g[f]=new o(n[m],n[m+1])):g[f]=Je(We(g[f-2]),g[f-7],_e(g[f-15]),g[f-16]),d=Qe(l,et(u),(b=c,y=a,new o((A=u).N&b.N^~A.N&y.N,A.I&b.I^~A.I&y.I)),tt[f],g[f]),h=R(Ze(r),qe(r,t,s)),l=a,a=c,c=u,u=R(i,d),i=s,s=t,t=r,r=R(d,h);var A,b,y;return e[0]=R(r,e[0]),e[1]=R(t,e[1]),e[2]=R(s,e[2]),e[3]=R(i,e[3]),e[4]=R(u,e[4]),e[5]=R(c,e[5]),e[6]=R(a,e[6]),e[7]=R(l,e[7]),e}let nt=class extends G{constructor(n,e,r){if(n!=="SHA-384"&&n!=="SHA-512")throw new Error(X);super(n,e,r);const t=r||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=k(this.t,this.i,this.T),this.v=le,this.L=function(s){return s.slice()},this.B=ce,this.F=function(s,i,u,c){return function(a,l,d,h,f){let m,g;const A=31+(l+129>>>10<<5),b=l+d;for(;a.length<=A;)a.push(0);for(a[l>>>5]|=128<<24-l%32,a[A]=4294967295&b,a[A-1]=b/P|0,m=0;m<a.length;m+=32)h=le(a.slice(m,m+32),h);return g=f==="SHA-384"?[h[0].N,h[0].I,h[1].N,h[1].I,h[2].N,h[2].I,h[3].N,h[3].I,h[4].N,h[4].I,h[5].N,h[5].I]:[h[0].N,h[0].I,h[1].N,h[1].I,h[2].N,h[2].I,h[3].N,h[3].I,h[4].N,h[4].I,h[5].N,h[5].I,h[6].N,h[6].I,h[7].N,h[7].I],g}(s,i,u,c,n)},this.U=ce(n),this.m=1024,this.R=n==="SHA-384"?384:512,this.K=!1,t.hmacKey&&this.k(j("hmacKey",t.hmacKey,this.T))}};const rt=[new o(0,1),new o(0,32898),new o(2147483648,32906),new o(2147483648,2147516416),new o(0,32907),new o(0,2147483649),new o(2147483648,2147516545),new o(2147483648,32777),new o(0,138),new o(0,136),new o(0,2147516425),new o(0,2147483658),new o(0,2147516555),new o(2147483648,139),new o(2147483648,32905),new o(2147483648,32771),new o(2147483648,32770),new o(2147483648,128),new o(0,32778),new o(2147483648,2147483658),new o(2147483648,2147516545),new o(2147483648,32896),new o(0,2147483649),new o(2147483648,2147516424)],st=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function Q(n){let e;const r=[];for(e=0;e<5;e+=1)r[e]=[new o(0,0),new o(0,0),new o(0,0),new o(0,0),new o(0,0)];return r}function it(n){let e;const r=[];for(e=0;e<5;e+=1)r[e]=n[e].slice();return r}function O(n,e){let r,t,s,i;const u=[],c=[];if(n!==null)for(t=0;t<n.length;t+=2)e[(t>>>1)%5][(t>>>1)/5|0]=Y(e[(t>>>1)%5][(t>>>1)/5|0],new o(n[t+1],n[t]));for(r=0;r<24;r+=1){for(i=Q(),t=0;t<5;t+=1)u[t]=(a=e[t][0],l=e[t][1],d=e[t][2],h=e[t][3],f=e[t][4],new o(a.N^l.N^d.N^h.N^f.N,a.I^l.I^d.I^h.I^f.I));for(t=0;t<5;t+=1)c[t]=Y(u[(t+4)%5],ae(u[(t+1)%5],1));for(t=0;t<5;t+=1)for(s=0;s<5;s+=1)e[t][s]=Y(e[t][s],c[t]);for(t=0;t<5;t+=1)for(s=0;s<5;s+=1)i[s][(2*t+3*s)%5]=ae(e[t][s],st[t][s]);for(t=0;t<5;t+=1)for(s=0;s<5;s+=1)e[t][s]=Y(i[t][s],new o(~i[(t+1)%5][s].N&i[(t+2)%5][s].N,~i[(t+1)%5][s].I&i[(t+2)%5][s].I));e[0][0]=Y(e[0][0],rt[r])}var a,l,d,h,f;return e}function Le(n){let e,r,t=0;const s=[0,0],i=[4294967295&n,n/P&2097151];for(e=6;e>=0;e--)r=i[e>>2]>>>8*e&255,r===0&&t===0||(s[t+1>>2]|=r<<8*(t+1),t+=1);return t=t!==0?t:1,s[0]|=t,{value:t+1>4?s:[s[0]],binLen:8+8*t}}function J(n){return V(Le(n.binLen),n)}function fe(n,e){let r,t=Le(e);t=V(t,n);const s=e>>>2,i=(s-t.value.length%s)%s;for(r=0;r<i;r++)t.value.push(0);return t.value}let ot=class extends G{constructor(n,e,r){let t=6,s=0;super(n,e,r);const i=r||{};if(this.numRounds!==1){if(i.kmacKey||i.hmacKey)throw new Error(Ie);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=k(this.t,this.i,this.T),this.v=O,this.L=it,this.B=Q,this.U=Q(),this.K=!1,n){case"SHA3-224":this.m=s=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=s=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=s=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=s=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":t=31,this.m=s=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":t=31,this.m=s=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":t=4,this.m=s=1344,this.X(r),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":t=4,this.m=s=1088,this.X(r),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=s=1344,t=this.O(r),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=s=1088,t=this.O(r),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(X)}this.F=function(u,c,a,l,d){return function(h,f,m,g,A,b,y){let I,L,E=0;const H=[],z=A>>>5,He=f>>>5;for(I=0;I<He&&f>=A;I+=z)g=O(h.slice(I,I+z),g),f-=A;for(h=h.slice(I),f%=A;h.length<z;)h.push(0);for(I=f>>>3,h[I>>2]^=b<<I%4*8,h[z-1]^=2147483648,g=O(h,g);32*H.length<y&&(L=g[E%5][E/5|0],H.push(L.I),!(32*H.length>=y));)H.push(L.N),E+=1,64*E%A==0&&(O(null,g),E=0);return H}(u,c,0,l,s,t,d)},i.hmacKey&&this.k(j("hmacKey",i.hmacKey,this.T))}O(n,e){const r=function(s){const i=s||{};return{funcName:j("funcName",i.funcName,1,{value:[],binLen:0}),customization:j("Customization",i.customization,1,{value:[],binLen:0})}}(n||{});e&&(r.funcName=e);const t=V(J(r.funcName),J(r.customization));if(r.customization.binLen!==0||r.funcName.binLen!==0){const s=fe(t,this.m>>>3);for(let i=0;i<s.length;i+=this.m>>>5)this.U=this.v(s.slice(i,i+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(n){const e=function(t){const s=t||{};return{kmacKey:j("kmacKey",s.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:j("Customization",s.customization,1,{value:[],binLen:0})}}(n||{});this.O(n,e.funcName);const r=fe(J(e.kmacKey),this.m>>>3);for(let t=0;t<r.length;t+=this.m>>>5)this.U=this.v(r.slice(t,t+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(n){const e=V({value:this.h.slice(),binLen:this.u},function(r){let t,s,i=0;const u=[0,0],c=[4294967295&r,r/P&2097151];for(t=6;t>=0;t--)s=c[t>>2]>>>8*t&255,s===0&&i===0||(u[i>>2]|=s<<8*i,i+=1);return i=i!==0?i:1,u[i>>2]|=i<<8*i,{value:i+1>4?u:[u[0]],binLen:8+8*i}}(n.outputLen));return this.F(e.value,e.binLen,this.A,this.L(this.U),n.outputLen)}};class ut{constructor(e,r,t){if(e=="SHA-1")this.P=new Ve(e,r,t);else if(e=="SHA-224"||e=="SHA-256")this.P=new Ge(e,r,t);else if(e=="SHA-384"||e=="SHA-512")this.P=new nt(e,r,t);else{if(e!="SHA3-224"&&e!="SHA3-256"&&e!="SHA3-384"&&e!="SHA3-512"&&e!="SHAKE128"&&e!="SHAKE256"&&e!="CSHAKE128"&&e!="CSHAKE256"&&e!="KMAC128"&&e!="KMAC256")throw new Error(X);this.P=new ot(e,r,t)}}update(e){return this.P.update(e),this}getHash(e,r){return this.P.getHash(e,r)}setHMACKey(e,r,t){this.P.setHMACKey(e,r,t)}getHMAC(e,r){return this.P.getHMAC(e,r)}}const T=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__<"u")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global})(),ht={SHA1:"SHA-1",SHA224:"SHA-224",SHA256:"SHA-256",SHA384:"SHA-384",SHA512:"SHA-512","SHA3-224":"SHA3-224","SHA3-256":"SHA3-256","SHA3-384":"SHA3-384","SHA3-512":"SHA3-512"},at=(n,e,r)=>{{const t=ht[n.toUpperCase()];if(typeof t>"u")throw new TypeError("Unknown hash function");const s=new ut(t,"ARRAYBUFFER");return s.setHMACKey(e,"ARRAYBUFFER"),s.update(r),s.getHMAC("ARRAYBUFFER")}},W="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",ct=n=>{let e=n.length;for(;n[e-1]==="=";)--e;const r=(e<n.length?n.substring(0,e):n).toUpperCase(),t=new ArrayBuffer(r.length*5/8|0),s=new Uint8Array(t);let i=0,u=0,c=0;for(let a=0;a<r.length;a++){const l=W.indexOf(r[a]);if(l===-1)throw new TypeError(`Invalid character found: ${r[a]}`);u=u<<5|l,i+=5,i>=8&&(i-=8,s[c++]=u>>>i)}return t},lt=n=>{const e=new Uint8Array(n);let r=0,t=0,s="";for(let i=0;i<e.length;i++)for(t=t<<8|e[i],r+=8;r>=5;)s+=W[t>>>r-5&31],r-=5;return r>0&&(s+=W[t<<5-r&31]),s},ft=n=>{const e=new ArrayBuffer(n.length/2),r=new Uint8Array(e);for(let t=0;t<n.length;t+=2)r[t/2]=parseInt(n.substring(t,t+2),16);return e},wt=n=>{const e=new Uint8Array(n);let r="";for(let t=0;t<e.length;t++){const s=e[t].toString(16);s.length===1&&(r+="0"),r+=s}return r.toUpperCase()},dt=n=>{const e=new ArrayBuffer(n.length),r=new Uint8Array(e);for(let t=0;t<n.length;t++)r[t]=n.charCodeAt(t)&255;return e},gt=n=>{const e=new Uint8Array(n);let r="";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},we=T.TextEncoder?new T.TextEncoder("utf-8"):null,de=T.TextDecoder?new T.TextDecoder("utf-8"):null,mt=n=>{if(!we)throw new Error("Encoding API not available");return we.encode(n).buffer},At=n=>{if(!de)throw new Error("Encoding API not available");return de.decode(n)},pt=n=>{var e;{if(!((e=T.crypto)!=null&&e.getRandomValues))throw new Error("Cryptography API not available");return T.crypto.getRandomValues(new Uint8Array(n)).buffer}};class C{constructor({buffer:e,size:r=20}={}){this.buffer=typeof e>"u"?pt(r):e}static fromLatin1(e){return new C({buffer:dt(e)})}static fromUTF8(e){return new C({buffer:mt(e)})}static fromBase32(e){return new C({buffer:ct(e)})}static fromHex(e){return new C({buffer:ft(e)})}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,value:gt(this.buffer)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,value:At(this.buffer)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,value:lt(this.buffer)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,value:wt(this.buffer)}),this.hex}}const bt=(n,e)=>{{if(n.length!==e.length)throw new TypeError("Input strings must have the same length");let r=-1,t=0;for(;++r<n.length;)t|=n.charCodeAt(r)^e.charCodeAt(r);return t===0}};class v{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,counter:0,window:1}}constructor({issuer:e=v.defaults.issuer,label:r=v.defaults.label,issuerInLabel:t=v.defaults.issuerInLabel,secret:s=new C,algorithm:i=v.defaults.algorithm,digits:u=v.defaults.digits,counter:c=v.defaults.counter}={}){this.issuer=e,this.label=r,this.issuerInLabel=t,this.secret=typeof s=="string"?C.fromBase32(s):s,this.algorithm=i.toUpperCase(),this.digits=u,this.counter=c}static generate({secret:e,algorithm:r=v.defaults.algorithm,digits:t=v.defaults.digits,counter:s=v.defaults.counter}){const i=new Uint8Array(at(r,e.buffer,Ye(s))),u=i[i.byteLength-1]&15;return(((i[u]&127)<<24|(i[u+1]&255)<<16|(i[u+2]&255)<<8|i[u+3]&255)%10**t).toString().padStart(t,"0")}generate({counter:e=this.counter++}={}){return v.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:e})}static validate({token:e,secret:r,algorithm:t,digits:s,counter:i=v.defaults.counter,window:u=v.defaults.window}){if(e.length!==s)return null;let c=null;for(let a=i-u;a<=i+u;++a){const l=v.generate({secret:r,algorithm:t,digits:s,counter:a});bt(e,l)&&(c=a-i)}return c}validate({token:e,counter:r=this.counter,window:t}){return v.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:r,window:t})}toString(){const e=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&counter=${e(this.counter)}`}}class S{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,period:30,window:1}}constructor({issuer:e=S.defaults.issuer,label:r=S.defaults.label,issuerInLabel:t=S.defaults.issuerInLabel,secret:s=new C,algorithm:i=S.defaults.algorithm,digits:u=S.defaults.digits,period:c=S.defaults.period}={}){this.issuer=e,this.label=r,this.issuerInLabel=t,this.secret=typeof s=="string"?C.fromBase32(s):s,this.algorithm=i.toUpperCase(),this.digits=u,this.period=c}static generate({secret:e,algorithm:r,digits:t,period:s=S.defaults.period,timestamp:i=Date.now()}){return v.generate({secret:e,algorithm:r,digits:t,counter:Math.floor(i/1e3/s)})}generate({timestamp:e=Date.now()}={}){return S.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:e})}static validate({token:e,secret:r,algorithm:t,digits:s,period:i=S.defaults.period,timestamp:u=Date.now(),window:c}){return v.validate({token:e,secret:r,algorithm:t,digits:s,counter:Math.floor(u/1e3/i),window:c})}validate({token:e,timestamp:r,window:t}){return S.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:r,window:t})}toString(){const e=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&period=${e(this.period)}`}}const It=({totps:n})=>p.jsx("div",{children:p.jsx(ne,{children:n==null?void 0:n.map(e=>p.jsx(ne.Item,{},e.secretKey))})}),vt=({totp:n})=>{const[e,r]=K.useState(0),[t,s]=K.useState("");K.useEffect(()=>{if(r(0),n){const c=$().second(),a=$().valueOf(),l=(c>=30?60-c:30-c)*1e3;r(a+l),s(n.generate())}},[n]);const[i]=ke({targetDate:e,onEnd:()=>{if(r(0),n){const c=$().second(),a=$().valueOf(),l=(c>=30?60-c:30-c)*1e3;r(a+l),s(n.generate())}}}),u=()=>p.jsx(Ue,{type:"circle",percent:(30-Math.round(i/1e3))/30*100,format:()=>Math.round(i/1e3),size:20});return p.jsx(ge.Item,{label:"Token",children:p.jsxs(_.Compact,{children:[p.jsx(ee,{value:t,addonAfter:p.jsx(u,{})}),p.jsx(me,{text:t})]})})},Nt=({totp:n})=>p.jsxs("div",{children:[p.jsx("div",{children:p.jsx(xe,{value:(n==null?void 0:n.toString())||"-",style:{width:128,height:128}})}),p.jsx("div",{className:"mt-4",children:p.jsx(vt,{totp:n})}),p.jsx("div",{className:"mt-4",children:p.jsxs(_.Compact,{className:"w-full",children:[p.jsx(ee,{value:(n==null?void 0:n.toString())||""}),p.jsx(me,{text:n==null?void 0:n.toString()})]})})]}),yt=()=>{const[n]=ge.useForm(),[e,r]=K.useState(),t=()=>{const i=new C;n.setFieldValue("secret",i.base32)},s=async i=>{console.log(i);const u=new S({issuer:i.issuer,label:i.account,secret:i.secretKey});return r(u),!0};return p.jsxs(p.Fragment,{children:[p.jsxs(q,{form:n,layout:"horizontal",onFinish:s,children:[p.jsx(te,{label:"Issuer",name:"issuer",required:!0}),p.jsx(te,{label:"Account",name:"account"}),p.jsx(q.Item,{shouldUpdate:!0,children:i=>p.jsx(q.Item,{label:"Secret Key",name:"secret",required:!0,children:p.jsxs(_.Compact,{style:{width:"100%"},children:[p.jsx(ee,{value:i.getFieldValue("secret"),showCount:!0}),p.jsx(Be,{icon:p.jsx(Fe,{icon:"material-symbols:refresh"}),onClick:t})]})})})]}),p.jsx(Nt,{totp:e})]})},xt=()=>{const[n]=Ce("totps",{defaultValue:[]});return console.log(C.fromUTF8("ha")),p.jsx(Re,{title:!1,className:"pt-4",children:p.jsxs("div",{className:"grid grid-cols-3",children:[p.jsx("div",{className:"col-span-1",children:p.jsx(It,{totps:n})}),p.jsx("div",{className:"col-span-2",children:p.jsx(yt,{})})]})})};export{xt as Component};
//# sourceMappingURL=page-C90tGb0Z.js.map
