{"version":3,"file":"static/js/2769.1b5ec5e2.chunk.js","mappings":"0QAmFA,UAjEoB,WAClB,OAAwBA,EAAAA,EAAAA,UAAiB,MAAK,eAAvCC,EAAI,KAAEC,EAAO,KACpB,GAAwBF,EAAAA,EAAAA,UAA0B,IAAG,eAA9CG,EAAI,KAAEC,EAAO,KACpB,GAAsBJ,EAAAA,EAAAA,UAAqB,CACzCK,WAAW,EACXC,iBAAiB,EACjBC,QAAS,EACTC,MAAM,EACNC,SAAU,KALLC,GAML,YANgB,GAyClB,OAlCAC,EAAAA,EAAAA,YAAU,WACR,IACE,IAAMC,EAASC,IAAAA,MAAYZ,GAE3B,GADAa,QAAQC,IAAIH,GACRI,MAAMC,QAAQL,GAAS,CACzB,IAAIM,EAAiB,GACrBN,EAAOO,SAAQ,SAACC,GACDC,OAAOC,KAAKF,GACpBD,SAAQ,SAACI,GACZL,EAAQM,KAAK,CAAEC,MAAOF,EAAKG,UAAU,GACvC,GACF,IACAR,EAAUS,IAAAA,SAAWT,GAAS,SAACU,EAAGC,GAChC,OAAOD,EAAEH,QAAUI,EAAEJ,KACvB,IAEA,IAAMK,EAAc,GACpBlB,EAAOO,SAAQ,SAACC,GACd,IAAMW,EAAMb,EAAQc,KAAI,SAACC,GAEvB,MAAO,CAAER,MADKL,EAAKa,EAAOR,QAAU,KACpBC,UAAU,EAC5B,IACAI,EAAKN,KAAKO,EACZ,IAEA3B,EAAQ,CAACc,GAAO,OAAKY,GACvB,CAKF,CAJE,MAAOI,GACHA,aAAaC,aACfrB,QAAQsB,MAAMF,EAAEG,QAEpB,CACF,GAAG,CAACpC,KAGF,UAAC,IAAG,YACF,SAAC,IAAG,CAACqC,GAAI,CAAEC,MAAO,OAAQC,OAAQ,SAAU,UAC1C,SAAC,KAAS,CACRC,MAAM,WACNC,YAAY,OACZC,WAAYjC,EACZe,MAAOxB,EACP2C,SAAU1C,EACV2C,KAAK,QACLN,MAAM,OACNC,OAAO,YAGX,SAAC,IAAG,CAACF,GAAI,CAAEQ,GAAI,EAAGP,MAAO,QAAS,UAChC,SAAC,KAAc,CAACpC,KAAMA,EAAM4C,cAAe,SAACC,GAAG,OAAKA,EAAIvB,KAAK,QAIrE,C","sources":["pages/json/JsonToExcel.tsx"],"sourcesContent":["import { Box } from '@mui/material';\nimport JSON5 from 'json5';\nimport _ from 'lodash';\nimport { useEffect, useState } from 'react';\nimport AceEditor from 'react-ace';\nimport { AceOptions } from 'react-ace/types';\nimport ReactDataSheet from 'react-datasheet';\n\nimport 'ace-builds/src-min-noconflict/ext-searchbox';\nimport 'ace-builds/src-min-noconflict/mode-json5';\nimport 'ace-builds/src-min-noconflict/mode-yaml';\nimport 'ace-builds/src-min-noconflict/theme-textmate';\nimport 'react-datasheet/lib/react-datasheet.css';\n\nexport interface GridElement extends ReactDataSheet.Cell<GridElement, number | string | null> {\n  value: number | string | null;\n}\n\nconst JsonToExcel = () => {\n  const [json, setJson] = useState<string>('{}');\n  const [data, setData] = useState<GridElement[][]>([]);\n  const [jsonOptions] = useState<AceOptions>({\n    useWorker: false,\n    showLineNumbers: true,\n    tabSize: 2,\n    wrap: true,\n    fontSize: 14,\n  });\n  useEffect(() => {\n    try {\n      const result = JSON5.parse(json);\n      console.log(result);\n      if (Array.isArray(result)) {\n        let columns: any[] = [];\n        result.forEach((item) => {\n          const keys = Object.keys(item);\n          keys.forEach((key) => {\n            columns.push({ value: key, readOnly: true });\n          });\n        });\n        columns = _.uniqWith(columns, (a, b) => {\n          return a.value === b.value;\n        });\n\n        const rows: any[] = [];\n        result.forEach((item) => {\n          const row = columns.map((column) => {\n            const value = item[column.value] || null;\n            return { value, readOnly: true };\n          });\n          rows.push(row);\n        });\n        // @ts-ignore\n        setData([columns, ...rows]);\n      }\n    } catch (e) {\n      if (e instanceof SyntaxError) {\n        console.error(e.message);\n      }\n    }\n  }, [json]);\n\n  return (\n    <Box>\n      <Box sx={{ width: '100%', height: '300px' }}>\n        <AceEditor\n          theme=\"textmate\"\n          placeholder=\"JSON\"\n          setOptions={jsonOptions}\n          value={json}\n          onChange={setJson}\n          mode=\"json5\"\n          width=\"100%\"\n          height=\"100%\"\n        />\n      </Box>\n      <Box sx={{ mt: 3, width: '100%' }}>\n        <ReactDataSheet data={data} valueRenderer={(cel) => cel.value} />\n      </Box>\n    </Box>\n  );\n};\n\nexport default JsonToExcel;\n"],"names":["useState","json","setJson","data","setData","useWorker","showLineNumbers","tabSize","wrap","fontSize","jsonOptions","useEffect","result","JSON5","console","log","Array","isArray","columns","forEach","item","Object","keys","key","push","value","readOnly","_","a","b","rows","row","map","column","e","SyntaxError","error","message","sx","width","height","theme","placeholder","setOptions","onChange","mode","mt","valueRenderer","cel"],"sourceRoot":""}