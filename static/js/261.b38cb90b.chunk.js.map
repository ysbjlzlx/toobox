{"version":3,"file":"static/js/261.b38cb90b.chunk.js","mappings":"+SAYMA,GAAQC,EAAAA,EAAAA,IAAO,QAAPA,CAAgB,CAC5BC,QAAS,SAGLC,EAAsB,CAC1BC,WAAW,EACXC,QAAS,EACTC,MAAM,GAGO,SAASC,IACtB,IAAAC,GAA4BC,EAAAA,EAAAA,YAAkBC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAvCI,EAAMF,EAAA,GAAEG,EAASH,EAAA,GAsCxB,OACEI,EAAAA,EAAAA,MAACC,EAAAA,EAAS,CAAAC,SAAA,EACRC,EAAAA,EAAAA,KAACC,EAAAA,EAAG,CAACC,GAAI,CAAEC,GAAI,GAAIJ,UACjBC,EAAAA,EAAAA,KAACI,EAAAA,EAAU,CAACC,QAAQ,KAAIN,SAAC,yBAE3BF,EAAAA,EAAAA,MAACI,EAAAA,EAAG,CAACC,GAAI,CAAEC,GAAI,GAAIJ,SAAA,EACjBF,EAAAA,EAAAA,MAAA,SAAOS,QAAQ,wBAAuBP,SAAA,EACpCC,EAAAA,EAAAA,KAACjB,EAAK,CAACwB,OAAO,kBAAkBC,GAAG,wBAAwBC,UAAQ,EAACC,KAAK,OAAOC,SAhCvE,SAACC,GAChB,IAAMC,EAAQD,EAAME,OAAOD,MAC3B,GAAIA,EACF,IAAK,IAAIE,EAAI,EAAGA,EAAIF,EAAMG,OAAQD,IAAK,CACrC,IAAME,EAAa,IAAIC,WACvBD,EAAWE,OAAS,SAACC,GACnB,GAAKA,EAAEN,OAAP,CAGA,IAAIO,EAAOD,EAAEN,OAAOnB,OACpB0B,EAAO,IAAIC,WAAWD,GACtB,IAAME,EAAWC,EAAAA,GAAUH,EAAM,CAAEX,KAAM,UACzCe,QAAQC,IAAIH,GACZ,IAAMI,EAAaJ,EAASK,OAAOL,EAASM,WAAW,IACjDC,EAAON,EAAAA,GAAAA,cAAyBG,IAAe,GACrD/B,EAAUmC,KAAKC,UAAUF,EAAM,KAAM,GAPrC,CAQF,EAEA,IAAMG,EAAOpB,EAAMqB,KAAKnB,GACpBkB,GACFhB,EAAWkB,kBAAkBF,EAEjC,CAEJ,KASQjC,EAAAA,EAAAA,KAACoC,EAAAA,EAAM,CAAC/B,QAAQ,YAAYgC,UAAU,OAAMtC,SAAC,2BAI/CC,EAAAA,EAAAA,KAACoC,EAAAA,EAAM,CAACE,QAhDD,WACX,GAAK3C,GAAqB,KAAXA,EAAf,CAGA,IAAM4C,EAAIC,KAAKC,MACTR,EAAO,IAAIS,KAAK,CAAC/C,GAAS4C,EAAI,QAAS,CAC3C7B,KAAM,6BAERiC,IAAAA,OAAiBV,EALjB,CAMF,EAuC4BlC,SAAC,6CAEzBC,EAAAA,EAAAA,KAACC,EAAAA,EAAG,CAACC,GAAI,CAAEC,GAAI,GAAIJ,UACjBC,EAAAA,EAAAA,KAAC4C,EAAAA,GAAS,CAACC,KAAK,OAAOC,MAAM,UAAUC,MAAM,OAAOC,WAAY9D,EAAS+D,MAAOtD,QAIxF,C","sources":["pages/Excel.tsx"],"sourcesContent":["import { Box, Button, Container, Typography } from '@mui/material';\nimport { styled } from '@mui/material/styles';\nimport FileSaver from 'file-saver';\nimport { ChangeEvent, useState } from 'react';\nimport * as xlsx from 'xlsx';\n\nimport AceEditor from 'react-ace';\nimport { AceOptions } from 'react-ace/types';\n\nimport 'ace-builds/src-noconflict/mode-json';\nimport 'ace-builds/src-noconflict/theme-monokai';\n\nconst Input = styled('input')({\n  display: 'none',\n});\n\nconst options: AceOptions = {\n  useWorker: false,\n  tabSize: 2,\n  wrap: true,\n};\n\nexport default function Excel() {\n  const [result, setResult] = useState<string>();\n\n  const save = () => {\n    if (!result || result === '') {\n      return;\n    }\n    const t = Date.now();\n    const file = new File([result], t + '.json', {\n      type: 'text/plain;charset=utf-8',\n    });\n    FileSaver.saveAs(file);\n  };\n\n  const onUpload = (event: ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files;\n    if (files) {\n      for (let i = 0; i < files.length; i++) {\n        const fileReader = new FileReader();\n        fileReader.onload = (e: ProgressEvent<FileReader>) => {\n          if (!e.target) {\n            return;\n          }\n          let data = e.target.result as ArrayBuffer;\n          data = new Uint8Array(data);\n          const workbook = xlsx.read(data, { type: 'array' });\n          console.log(workbook);\n          const firstSheet = workbook.Sheets[workbook.SheetNames[0]];\n          const rows = xlsx.utils.sheet_to_json(firstSheet) || [];\n          setResult(JSON.stringify(rows, null, 2));\n        };\n\n        const file = files.item(i);\n        if (file) {\n          fileReader.readAsArrayBuffer(file);\n        }\n      }\n    }\n  };\n  return (\n    <Container>\n      <Box sx={{ mt: 2 }}>\n        <Typography variant=\"h2\">Excel 转 JSON</Typography>\n      </Box>\n      <Box sx={{ mt: 2 }}>\n        <label htmlFor=\"contained-button-file\">\n          <Input accept=\".xls,.xlsx,.csv\" id=\"contained-button-file\" multiple type=\"file\" onChange={onUpload} />\n          <Button variant=\"contained\" component=\"span\">\n            上传 Excel\n          </Button>\n        </label>\n        <Button onClick={save}>下载为 JSON 文件</Button>\n      </Box>\n      <Box sx={{ mt: 2 }}>\n        <AceEditor mode=\"json\" theme=\"monokai\" width=\"100%\" setOptions={options} value={result} />\n      </Box>\n    </Container>\n  );\n}\n"],"names":["Input","styled","display","options","useWorker","tabSize","wrap","Excel","_useState","useState","_useState2","_slicedToArray","result","setResult","_jsxs","Container","children","_jsx","Box","sx","mt","Typography","variant","htmlFor","accept","id","multiple","type","onChange","event","files","target","i","length","fileReader","FileReader","onload","e","data","Uint8Array","workbook","xlsx","console","log","firstSheet","Sheets","SheetNames","rows","JSON","stringify","file","item","readAsArrayBuffer","Button","component","onClick","t","Date","now","File","FileSaver","AceEditor","mode","theme","width","setOptions","value"],"sourceRoot":""}