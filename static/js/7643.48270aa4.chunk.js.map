{"version":3,"file":"static/js/7643.48270aa4.chunk.js","mappings":"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","sources":["components/ContentCopyAdornment.tsx","pages/totp/AccountList.tsx","pages/totp/TokenField.tsx","pages/totp/TotpCard.tsx","pages/totp/DetailInfo.tsx","pages/totp/index.tsx"],"sourcesContent":["import { ContentCopy } from '@mui/icons-material';\nimport { IconButton, InputAdornment, Snackbar } from '@mui/material';\nimport ClipboardJS from 'clipboard';\nimport { useEffect, useRef, useState } from 'react';\n\ninterface Props {\n  content?: string | undefined;\n  onSuccess?: Function | undefined;\n}\n\nexport default function ContentCopyAdornment({ content, onSuccess }: Props) {\n  const btn = useRef<HTMLButtonElement>(null);\n  const [open, setOpen] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (btn.current) {\n      const clipboard = new ClipboardJS(btn.current);\n      clipboard.on('success', (e) => {\n        setOpen(true);\n      });\n      clipboard.on('error', (e) => {\n        console.error(e);\n      });\n    }\n  }, []);\n\n  return (\n    <>\n      <InputAdornment position=\"end\">\n        <IconButton ref={btn} data-clipboard-text={content} aria-label=\"Copy content\">\n          <ContentCopy />\n        </IconButton>\n      </InputAdornment>\n\n      <Snackbar open={open} onClose={() => setOpen(false)} autoHideDuration={3000} message=\"复制成功\" />\n    </>\n  );\n}\n","import { Box, List, ListItem, ListItemText } from '@mui/material';\nimport { TotpI } from './typings';\n\ninterface Props {\n  totps?: TotpI[];\n}\n\nconst AccountList = ({ totps }: Props) => {\n  return (\n    <Box>\n      <List>\n        {totps?.map((totp) => {\n          return (\n            <ListItem key={totp.secretKey}>\n              <ListItemText>ha</ListItemText>\n            </ListItem>\n          );\n        })}\n      </List>\n    </Box>\n  );\n};\n\nexport default AccountList;\n","import { Box, CircularProgress, TextField, Typography } from '@mui/material';\nimport { useCountDown } from 'ahooks';\nimport dayjs from 'dayjs';\nimport { TOTP } from 'otpauth';\nimport { useEffect, useState } from 'react';\nimport ContentCopyAdornment from '../../components/ContentCopyAdornment';\n\ninterface Props {\n  totp?: TOTP;\n}\n\nconst TokenField = ({ totp }: Props) => {\n  const [targetDate, setTargetDate] = useState<number>(0);\n  const [token, setToken] = useState<string>('');\n\n  useEffect(() => {\n    setTargetDate(0);\n    if (totp) {\n      const second = dayjs().second();\n      const millisecond = dayjs().valueOf();\n      const duration = (second >= 30 ? 60 - second : 30 - second) * 1000;\n      setTargetDate(millisecond + duration);\n      setToken(totp.generate());\n    }\n  }, [totp]);\n\n  const [countTime] = useCountDown({\n    targetDate,\n    onEnd: () => {\n      setTargetDate(0);\n      if (totp) {\n        const second = dayjs().second();\n        const millisecond = dayjs().valueOf();\n        const duration = (second >= 30 ? 60 - second : 30 - second) * 1000;\n        setTargetDate(millisecond + duration);\n        setToken(totp.generate());\n      }\n    },\n  });\n\n  return (\n    <TextField\n      label=\"Token\"\n      value={token}\n      InputProps={{\n        endAdornment: (\n          <>\n            <Box sx={{ position: 'relative', display: 'inline-flex' }}>\n              <CircularProgress variant=\"determinate\" value={((30 - Math.round(countTime / 1000)) / 30) * 100} />\n              <Box\n                sx={{\n                  top: 0,\n                  left: 0,\n                  bottom: 0,\n                  right: 0,\n                  position: 'absolute',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                }}\n              >\n                <Typography variant=\"caption\" component=\"div\" color=\"text.secondary\">\n                  {Math.round(countTime / 1000)}\n                </Typography>\n              </Box>\n            </Box>\n            <ContentCopyAdornment content={token} />\n          </>\n        ),\n      }}\n    />\n  );\n};\nexport default TokenField;\n","import { Box, TextField } from '@mui/material';\nimport { TOTP } from 'otpauth';\nimport QRCode from 'qrcode';\nimport { useEffect, useMemo, useRef } from 'react';\n\nimport ContentCopyAdornment from '../../components/ContentCopyAdornment';\nimport TokenField from './TokenField';\n\ninterface Props {\n  totp?: TOTP;\n}\n\nconst TotpCard = ({ totp }: Props) => {\n  const qrcodeContainer = useRef<HTMLCanvasElement>(null);\n  const options = useMemo(() => {\n    return { width: 128, height: 128 };\n  }, []);\n\n  useEffect(() => {\n    if (totp) {\n      QRCode.toCanvas(qrcodeContainer.current, totp.toString(), options);\n    }\n  }, [options, totp]);\n  return (\n    <Box>\n      <Box sx={options}>\n        <canvas ref={qrcodeContainer} />\n      </Box>\n      <Box sx={{ mt: 2 }}>\n        <TokenField totp={totp} />\n      </Box>\n\n      <Box sx={{ mt: 2 }}>\n        <TextField\n          label=\"URI\"\n          value={totp?.toString() || ''}\n          InputProps={{ endAdornment: <ContentCopyAdornment content={totp?.toString()} /> }}\n          fullWidth\n        />\n      </Box>\n    </Box>\n  );\n};\nexport default TotpCard;\n","import { Refresh as RefreshIcon } from '@mui/icons-material';\nimport { Box, Button, IconButton, InputAdornment, TextField } from '@mui/material';\nimport * as OTPAuth from 'otpauth';\nimport { Controller, useForm } from 'react-hook-form';\n\nimport { useState } from 'react';\nimport TotpCard from './TotpCard';\nimport { TotpI } from './typings';\n\nconst DetailInfo = () => {\n  const [instance, setInstance] = useState<OTPAuth.TOTP>();\n  const { register, handleSubmit, setValue, control } = useForm<TotpI>({ defaultValues: { secretKey: '' } });\n\n  const refreshSecret = () => {\n    const secret = new OTPAuth.Secret();\n    setValue('secretKey', secret.base32, { shouldDirty: true, shouldTouch: true, shouldValidate: true });\n  };\n  const onSave = (data: TotpI) => {\n    const instance = new OTPAuth.TOTP({\n      issuer: data.issuer,\n      label: data.account,\n      secret: data.secretKey,\n    });\n    setInstance(instance);\n  };\n\n  return (\n    <>\n      <form onSubmit={handleSubmit(onSave)}>\n        <TextField label=\"Issuer\" {...register('issuer')} fullWidth required />\n        <Box sx={{ pt: 2 }}>\n          <TextField label=\"Account\" {...register('account')} fullWidth />\n        </Box>\n        <Box sx={{ pt: 2 }}>\n          <Controller\n            control={control}\n            name=\"secretKey\"\n            render={({ field }) => (\n              <TextField\n                label=\"Secret Key\"\n                {...field}\n                InputProps={{\n                  endAdornment: (\n                    <InputAdornment position=\"end\">\n                      <IconButton onClick={refreshSecret}>\n                        <RefreshIcon />\n                      </IconButton>\n                    </InputAdornment>\n                  ),\n                }}\n                fullWidth\n                required\n              />\n            )}\n          />\n        </Box>\n        <Box sx={{ pt: 2, float: 'right' }}>\n          <Button>取消</Button>\n          <Button type=\"submit\">保存</Button>\n        </Box>\n      </form>\n      <TotpCard totp={instance} />\n    </>\n  );\n};\n\nexport default DetailInfo;\n","import { Container } from '@mui/material';\nimport Grid from '@mui/material/Unstable_Grid2';\nimport { useLocalStorageState } from 'ahooks';\n\nimport * as OTPAuth from 'otpauth';\nimport AccountList from './AccountList';\nimport DetailInfo from './DetailInfo';\nimport { TotpI } from './typings';\n\nconst style = {\n  position: 'absolute' as 'absolute',\n  top: '50%',\n  left: '50%',\n  transform: 'translate(-50%, -50%)',\n  width: 400,\n  bgcolor: 'background.paper',\n  p: 4,\n\n  maxWidth: '700px',\n  boxShadow: 'rgb(97 97 97 / 20%) 0px 4px 20px',\n  borderRadius: 'clamp(0px, (100vw - 750px) * 9999, 10px)',\n};\n\nconst Totp = () => {\n  const [totps, setTotps] = useLocalStorageState<TotpI[]>('totps', { defaultValue: [] });\n\n  console.log(OTPAuth.Secret.fromUTF8('ha'));\n  return (\n    <Container>\n      <Grid container spacing={2} sx={{ mt: 2 }}>\n        <Grid xs={4}>\n          <AccountList totps={totps} />\n        </Grid>\n        <Grid xs={8}>\n          <DetailInfo />\n        </Grid>\n      </Grid>\n    </Container>\n  );\n};\nexport default Totp;\n"],"names":["ContentCopyAdornment","_ref","content","btn","onSuccess","useRef","_useState","useState","_useState2","_slicedToArray","open","setOpen","useEffect","current","clipboard","ClipboardJS","on","e","console","error","_jsxs","_Fragment","children","_jsx","InputAdornment","position","IconButton","ref","ContentCopy","Snackbar","onClose","autoHideDuration","message","totps","Box","List","map","totp","ListItem","ListItemText","secretKey","targetDate","setTargetDate","_useState3","_useState4","token","setToken","second","dayjs","millisecond","valueOf","generate","_useCountDown","useCountDown","onEnd","countTime","TextField","label","value","InputProps","endAdornment","sx","display","CircularProgress","variant","Math","round","top","left","bottom","right","alignItems","justifyContent","Typography","component","color","qrcodeContainer","options","useMemo","width","height","QRCode","toString","mt","TokenField","fullWidth","instance","setInstance","_useForm","useForm","defaultValues","register","handleSubmit","setValue","control","refreshSecret","secret","OTPAuth","base32","shouldDirty","shouldTouch","shouldValidate","onSubmit","data","issuer","account","_objectSpread","required","pt","Controller","name","render","field","onClick","RefreshIcon","float","Button","type","TotpCard","_useLocalStorageState","useLocalStorageState","defaultValue","_useLocalStorageState2","log","Container","Grid","container","spacing","xs","AccountList","DetailInfo"],"sourceRoot":""}