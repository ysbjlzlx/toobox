(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3772,9497],{81771:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(40431),a=n(46750),o=n(86006),i=n(89791),u=n(4323),l=n(51579),s=n(86601),d=n(84502),c=n(9268);let f=["className","component"];var p=n(47327),h=n(2516),v=n(86356);let y=(0,h.Z)(),b=function(e={}){let{themeId:t,defaultTheme:n,defaultClassName:p="MuiBox-root",generateClassName:h}=e,v=(0,u.ZP)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(l.Z),y=o.forwardRef(function(e,o){let u=(0,d.Z)(n),l=(0,s.Z)(e),{className:y,component:b="div"}=l,m=(0,a.Z)(l,f);return(0,c.jsx)(v,(0,r.Z)({as:b,ref:o,className:(0,i.Z)(y,h?h(p):p),theme:t&&u[t]||u},m))});return y}({themeId:v.Z,defaultTheme:y,defaultClassName:"MuiBox-root",generateClassName:p.Z.generate});var m=b},86601:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(40431),a=n(46750),o=n(95135),i=n(2272);let u=["sx"],l=e=>{var t,n;let r={systemProps:{},otherProps:{}},a=null!=(t=null==e?void 0:null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:i.Z;return Object.keys(e).forEach(t=>{a[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]}),r};function s(e){let t;let{sx:n}=e,i=(0,a.Z)(e,u),{systemProps:s,otherProps:d}=l(i);return t=Array.isArray(n)?[s,...n]:"function"==typeof n?(...e)=>{let t=n(...e);return(0,o.P)(t)?(0,r.Z)({},s,t):s}:(0,r.Z)({},s,n),(0,r.Z)({},d,{sx:t})}},81301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77986),a=n(56429);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});var o=n(26927);n(86006);var i=o._(n(1937));function u(e){return{default:(null==e?void 0:e.default)||e}}function l(e,t){var n=i.default,o={loading:function(e){return e.error,e.isLoading,e.pastDelay,null}};"function"==typeof e&&(o.loader=e),Object.assign(o,t);var l=o.loader;return n(a._(r._({},o),{loader:function(){return null!=l?l().then(u):Promise.resolve(u(function(){return null}))}}))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},77069:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{suspense:function(){return a},NoSSR:function(){return o}}),n(26927),n(86006);var r=n(34722);function a(){var e=Error(r.NEXT_DYNAMIC_NO_SSR_CODE);throw e.digest=r.NEXT_DYNAMIC_NO_SSR_CODE,e}function o(e){return e.children}},1937:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});var r=n(26927)._(n(86006)),a=n(77069),o=function(e){var t=function(e){var t=n.loading,o=r.default.createElement(t,{isLoading:!0,pastDelay:!0,error:null}),i=n.ssr?r.default.Fragment:a.NoSSR,u=n.lazy;return r.default.createElement(r.default.Suspense,{fallback:o},r.default.createElement(i,null,r.default.createElement(u,e)))},n=Object.assign({loader:null,loading:null,ssr:!0},e);return n.lazy=r.default.lazy(n.loader),t.displayName="LoadableComponent",t}},20324:function(){},97611:function(e,t,n){"use strict";var r=n(86054);function a(){}function o(){}o.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,o,i){if(i!==r){var u=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:a};return n.PropTypes=n,n}},79497:function(e,t,n){e.exports=n(97611)()},86054:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(86006),i=s(o),u=s(n(79497)),l=s(n(69900));function s(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.cell,n=e.row,a=e.col,o=e.attributesRenderer,u=e.className,l=e.style,s=e.onMouseDown,d=e.onMouseOver,c=e.onDoubleClick,f=e.onContextMenu,p=t.colSpan,h=t.rowSpan,v=o?o(t,n,a):{};return i.default.createElement("td",r({className:u,onMouseDown:s,onMouseOver:d,onDoubleClick:c,onTouchEnd:c,onContextMenu:f,colSpan:p,rowSpan:h,style:l},v),this.props.children)}}]),t}(o.PureComponent);t.default=d,d.propTypes={row:u.default.number.isRequired,col:u.default.number.isRequired,cell:u.default.shape(l.default).isRequired,selected:u.default.bool,editing:u.default.bool,updated:u.default.bool,attributesRenderer:u.default.func,onMouseDown:u.default.func.isRequired,onMouseOver:u.default.func.isRequired,onDoubleClick:u.default.func.isRequired,onContextMenu:u.default.func.isRequired,className:u.default.string,style:u.default.object},d.defaultProps={selected:!1,editing:!1,updated:!1,attributesRenderer:function(){}}},69900:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(79497))&&r.__esModule?r:{default:r},o={readOnly:a.default.bool,key:a.default.string,className:a.default.string,component:a.default.oneOfType([a.default.element,a.default.func]),forceComponent:a.default.bool,disableEvents:a.default.bool,disableUpdatedFlag:a.default.bool,colSpan:a.default.number,rowSpan:a.default.number,width:a.default.oneOfType([a.default.number,a.default.string]),overflow:a.default.oneOf(["wrap","nowrap","clip"]),dataEditor:a.default.func,valueViewer:a.default.func};t.default=o},23012:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(86006),o=p(a),i=p(n(79497)),u=n(43510),l=p(n(8530)),s=p(n(69900)),d=p(n(28344)),c=p(n(40274)),f=n(22748);function p(e){return e&&e.__esModule?e:{default:e}}function h(e){var t=e.cell,n=e.row,r=e.col,a=e.valueRenderer,o=e.dataRenderer;return(0,f.renderData)(t,n,r,a,o)}function v(e){var t=e.cell,n=e.row,r=e.col,a=e.valueRenderer;return(0,f.renderValue)(t,n,r,a)}var y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=n.handleChange.bind(n),n.handleCommit=n.handleCommit.bind(n),n.handleRevert=n.handleRevert.bind(n),n.handleKey=n.handleKey.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleContextMenu=n.handleContextMenu.bind(n),n.handleDoubleClick=n.handleDoubleClick.bind(n),n.state={updated:!1,reverting:!1,committing:!1,value:""},n}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.cell.disableUpdatedFlag||v(e)===v(this.props)||(this.setState({updated:!0}),this.timeout=setTimeout(function(){return t.setState({updated:!1})},700)),!0===this.props.editing&&!1===e.editing){var n=this.props.clearing?"":h(this.props);this.setState({value:n,reverting:!1})}!0!==e.editing||!1!==this.props.editing||this.state.reverting||this.state.committing||this.state.value===h(this.props)||this.props.onChange(this.props.row,this.props.col,this.state.value)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"handleChange",value:function(e){this.setState({value:e,committing:!1})}},{key:"handleCommit",value:function(e,t){var n=this.props,r=n.onChange,a=n.onNavigate;e!==h(this.props)?(this.setState({value:e,committing:!0}),r(this.props.row,this.props.col,e)):this.handleRevert(),t&&(t.preventDefault(),a(t,!0))}},{key:"handleRevert",value:function(){this.setState({reverting:!0}),this.props.onRevert()}},{key:"handleMouseDown",value:function(e){var t=this.props,n=t.row,r=t.col,a=t.onMouseDown;t.cell.disableEvents||a(n,r,e)}},{key:"handleMouseOver",value:function(e){var t=this.props,n=t.row,r=t.col,a=t.onMouseOver;t.cell.disableEvents||a(n,r)}},{key:"handleDoubleClick",value:function(e){var t=this.props,n=t.row,r=t.col,a=t.onDoubleClick;t.cell.disableEvents||a(n,r)}},{key:"handleContextMenu",value:function(e){var t=this.props,n=t.row,r=t.col,a=t.onContextMenu;t.cell.disableEvents||a(e,n,r)}},{key:"handleKey",value:function(e){var t=e.which||e.keyCode;if(t===u.ESCAPE_KEY)return this.handleRevert();var n=this.props,r=n.cell.component,a=n.forceEdit;(t===u.ENTER_KEY||t===u.TAB_KEY||!(a||r)&&[u.LEFT_KEY,u.RIGHT_KEY,u.UP_KEY,u.DOWN_KEY].includes(t))&&this.handleCommit(this.state.value,e)}},{key:"renderComponent",value:function(e,t){var n=t.component,r=t.readOnly,a=t.forceComponent;if(e&&!r||a)return n}},{key:"renderEditor",value:function(e,t,n,r,a){if(e){var i=t.dataEditor||a||d.default;return o.default.createElement(i,{cell:t,row:n,col:r,value:this.state.value,onChange:this.handleChange,onCommit:this.handleCommit,onRevert:this.handleRevert,onKeyDown:this.handleKey})}}},{key:"renderViewer",value:function(e,t,n,r,a){var i=e.valueViewer||a||c.default,u=(0,f.renderValue)(e,t,n,r);return o.default.createElement(i,{cell:e,row:t,col:n,value:u})}},{key:"render",value:function(){var e,t=this.props,n=t.row,r=t.col,a=t.cell,i=t.cellRenderer,u=t.valueRenderer,l=t.dataEditor,s=t.valueViewer,d=t.attributesRenderer,c=t.selected,f=t.editing,p=t.onKeyUp,h=this.state.updated,v=this.renderComponent(f,a)||this.renderEditor(f,a,n,r,l)||this.renderViewer(a,n,r,u,s),y=[a.className,"cell",a.overflow,c&&"selected",f&&"editing",a.readOnly&&"read-only",h&&"updated"].filter(function(e){return e}).join(" ");return o.default.createElement(i,{row:n,col:r,cell:a,selected:c,editing:f,updated:h,attributesRenderer:d,className:y,style:(e="number"==typeof a.width?a.width+"px":a.width)?{width:e}:null,onMouseDown:this.handleMouseDown,onMouseOver:this.handleMouseOver,onDoubleClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onKeyUp:p},v)}}]),t}(a.PureComponent);t.default=y,y.propTypes={row:i.default.number.isRequired,col:i.default.number.isRequired,cell:i.default.shape(s.default).isRequired,forceEdit:i.default.bool,selected:i.default.bool,editing:i.default.bool,editValue:i.default.any,clearing:i.default.bool,cellRenderer:i.default.func,valueRenderer:i.default.func.isRequired,dataRenderer:i.default.func,valueViewer:i.default.func,dataEditor:i.default.func,attributesRenderer:i.default.func,onNavigate:i.default.func.isRequired,onMouseDown:i.default.func.isRequired,onMouseOver:i.default.func.isRequired,onDoubleClick:i.default.func.isRequired,onContextMenu:i.default.func.isRequired,onChange:i.default.func.isRequired,onRevert:i.default.func.isRequired,onEdit:i.default.func},y.defaultProps={forceEdit:!1,selected:!1,editing:!1,clearing:!1,cellRenderer:l.default}},28344:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(86006),o=l(a),i=l(n(79497)),u=l(n(69900));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=n.handleChange.bind(n),n}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this._input.focus()}},{key:"handleChange",value:function(e){this.props.onChange(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.onKeyDown;return o.default.createElement("input",{ref:function(t){e._input=t},className:"data-editor",value:n,onChange:this.handleChange,onKeyDown:r})}}]),t}(a.PureComponent);t.default=s,s.propTypes={value:i.default.node.isRequired,row:i.default.number.isRequired,col:i.default.number.isRequired,cell:i.default.shape(u.default),onChange:i.default.func.isRequired,onCommit:i.default.func.isRequired,onRevert:i.default.func.isRequired,onKeyDown:i.default.func.isRequired}},18274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(86006),i=v(o),u=v(n(79497)),l=v(n(11476)),s=v(n(10119)),d=v(n(8530)),c=v(n(23012)),f=v(n(28344)),p=v(n(40274)),h=n(43510);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){return 0===Object.keys(e).length},b=function(e,t){for(var n=[],r=t-e>0,a=e;r?a<=t:a>=t;r?a++:a--)r?n.push(a):n.unshift(a);return n},m=function(e){return e.split(/\r\n|\n|\r/).map(function(e){return e.split("	")})},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseDown=n.onMouseDown.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onMouseOver=n.onMouseOver.bind(n),n.onDoubleClick=n.onDoubleClick.bind(n),n.onContextMenu=n.onContextMenu.bind(n),n.handleNavigate=n.handleNavigate.bind(n),n.handleKey=n.handleKey.bind(n).bind(n),n.handleCut=n.handleCut.bind(n),n.handleCopy=n.handleCopy.bind(n),n.handlePaste=n.handlePaste.bind(n),n.pageClick=n.pageClick.bind(n),n.onChange=n.onChange.bind(n),n.onRevert=n.onRevert.bind(n),n.isSelected=n.isSelected.bind(n),n.isEditing=n.isEditing.bind(n),n.isClearing=n.isClearing.bind(n),n.handleComponentKey=n.handleComponentKey.bind(n),n.handleKeyboardCellMovement=n.handleKeyboardCellMovement.bind(n),n.defaultState={start:{},end:{},selecting:!1,forceEdit:!1,editing:{},clear:{}},n.state=n.defaultState,n.removeAllListeners=n.removeAllListeners.bind(n),n.handleIEClipboardEvents=n.handleIEClipboardEvents.bind(n),n}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"removeAllListeners",value:function(){document.removeEventListener("mousedown",this.pageClick),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("cut",this.handleCut),document.removeEventListener("copy",this.handleCopy),document.removeEventListener("paste",this.handlePaste),document.removeEventListener("keydown",this.handleIEClipboardEvents)}},{key:"componentDidMount",value:function(){this.dgDom&&this.dgDom.addEventListener("keydown",this.handleComponentKey)}},{key:"componentWillUnmount",value:function(){this.dgDom&&this.dgDom.removeEventListener("keydown",this.handleComponentKey),this.removeAllListeners()}},{key:"isSelectionControlled",value:function(){return"selected"in this.props}},{key:"getState",value:function(){var e=this.state;if(this.isSelectionControlled()){var t=this.props.selected||{},n=t.start,a=t.end;e=r({},e,{start:n=n||this.defaultState.start,end:a=a||this.defaultState.end})}return e}},{key:"_setState",value:function(e){var t=this.props.editModeChanged;if(t&&e.editing){var n=!y(this.state.editing),r=!y(e.editing);n!=r&&t(r)}if(this.isSelectionControlled()&&("start"in e||"end"in e)){var a=e.start,o=e.end,i=function(e,t){var n={};for(var r in e)!(t.indexOf(r)>=0)&&Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["start","end"]),u=this.props,l=u.selected,s=u.onSelect;l=l||{},a||(a="start"in l?l.start:this.defaultState.start),o||(o="end"in l?l.end:this.defaultState.end),s&&s({start:a,end:o}),this.setState(i)}else this.setState(e)}},{key:"pageClick",value:function(e){this.props.disablePageClick||this.dgDom.contains(e.target)||(this.setState(this.defaultState),this.removeAllListeners())}},{key:"handleCut",value:function(e){if(y(this.state.editing)){e.preventDefault(),this.handleCopy(e);var t=this.getState(),n=t.start,r=t.end;this.clearSelectedCells(n,r)}}},{key:"handleIEClipboardEvents",value:function(e){e.ctrlKey&&(67===e.keyCode?this.handleCopy(e):88===e.keyCode?this.handleCut(e):(86===e.keyCode||86===e.which)&&this.handlePaste(e))}},{key:"handleCopy",value:function(e){if(y(this.state.editing)){e.preventDefault();var t=this.props,n=t.dataRenderer,r=t.valueRenderer,a=t.data,o=this.getState(),i=o.start,u=o.end;if(this.props.handleCopy)this.props.handleCopy({event:e,dataRenderer:n,valueRenderer:r,data:a,start:i,end:u,range:b});else{var l=b(i.i,u.i).map(function(e){return b(i.j,u.j).map(function(t){var o=a[e][t],i=n?n(o,e,t):null;return""===i||null==i?r(o,e,t):i}).join("	")}).join("\n");window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",l):e.clipboardData.setData("text/plain",l)}}}},{key:"handlePaste",value:function(e){if(y(this.state.editing)){var t=this.getState(),n=t.start,r=t.end;r={i:Math.max((n={i:Math.min(n.i,r.i),j:Math.min(n.j,r.j)}).i,r.i),j:Math.max(n.j,r.j)};var a=this.props.parsePaste||m,o=[],i=[];window.clipboardData&&window.clipboardData.getData?i=a(window.clipboardData.getData("Text")):e.clipboardData&&e.clipboardData.getData&&(i=a(e.clipboardData.getData("text/plain")));var u=this.props,l=u.data,s=u.onCellsChanged,d=u.onPaste,c=u.onChange;if(s){var f=[];i.forEach(function(e,t){e.forEach(function(e,a){var i=l[(r={i:n.i+t,j:n.j+a}).i]&&l[r.i][r.j];i?i.readOnly||o.push({cell:i,row:r.i,col:r.j,value:e}):f.push({row:r.i,col:r.j,value:e})})}),f.length?s(o,f):s(o)}else d?(i.forEach(function(e,t){var a=[];e.forEach(function(e,o){var i=l[(r={i:n.i+t,j:n.j+o}).i]&&l[r.i][r.j];a.push({cell:i,data:e})}),o.push(a)}),d(o)):c&&i.forEach(function(e,t){e.forEach(function(e,a){var o=l[(r={i:n.i+t,j:n.j+a}).i]&&l[r.i][r.j];o&&!o.readOnly&&c(o,r.i,r.j,e)})});this._setState({end:r})}}},{key:"handleKeyboardCellMovement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getState(),r=n.start,a=n.editing,o=this.props.data,i=a&&!y(a),u=o[r.i]&&o[r.i][r.j];if(i&&!t)return!1;var l=u&&u.component,s=e.which||e.keyCode;if(l&&i){e.preventDefault();return}s===h.TAB_KEY?this.handleNavigate(e,{i:0,j:e.shiftKey?-1:1},!0):s===h.RIGHT_KEY?this.handleNavigate(e,{i:0,j:1}):s===h.LEFT_KEY?this.handleNavigate(e,{i:0,j:-1}):s===h.UP_KEY?this.handleNavigate(e,{i:-1,j:0}):s===h.DOWN_KEY?this.handleNavigate(e,{i:1,j:0}):t&&s===h.ENTER_KEY&&this.handleNavigate(e,{i:e.shiftKey?-1:1,j:0})}},{key:"handleKey",value:function(e){if(!(e.isPropagationStopped&&e.isPropagationStopped())){var t=e.which||e.keyCode,n=this.getState(),r=n.start,a=n.end,o=n.editing,i=o&&!y(o),u=!r||y(r),l=e.ctrlKey||e.metaKey,s=t===h.DELETE_KEY||t===h.BACKSPACE_KEY,d=t===h.ENTER_KEY,c=t>=48&&t<=57,f=t>=65&&t<=90,p=t>=160&&t<=255,v=t>=96&&t<=105,b=!u&&this.props.data[r.i][r.j],m=[187,189,190,107,109,110].indexOf(t)>-1;if(u||l)return!0;!i&&(this.handleKeyboardCellMovement(e),s?(e.preventDefault(),this.clearSelectedCells(r,a)):b&&!b.readOnly&&(d?(this._setState({editing:r,clear:{},forceEdit:!0}),e.preventDefault()):(c||v||f||p||m)&&this._setState({editing:r,clear:r,forceEdit:!1})))}}},{key:"getSelectedCells",value:function(e,t,n){var r=[];return b(t.i,n.i).map(function(a){b(t.j,n.j).map(function(t){e[a]&&e[a][t]&&r.push({cell:e[a][t],row:a,col:t})})}),r}},{key:"clearSelectedCells",value:function(e,t){var n=this,a=this.props,o=a.data,i=a.onCellsChanged,u=a.onChange,l=this.getSelectedCells(o,e,t).filter(function(e){return!e.cell.readOnly}).map(function(e){return r({},e,{value:""})});i?(i(l),this.onRevert()):u&&setTimeout(function(){l.forEach(function(e){u(e.cell,e.row,e.col,e.value)}),n.onRevert()},0)}},{key:"updateLocationSingleCell",value:function(e){this._setState({start:e,end:e,editing:{}})}},{key:"updateLocationMultipleCells",value:function(e){var t=this.getState(),n=t.start,r=t.end,a=this.props.data,o={i:n.i,j:n.j},i={i:r.i+e.i,j:Math.min(a[0].length-1,Math.max(0,r.j+e.j))};this._setState({start:o,end:i,editing:{}})}},{key:"searchForNextSelectablePos",value:function(e,t,n,r,a){for(var o=function(e){return{i:e.i+r.i,j:e.j+r.j}},i=function(e){var n=e.i,r=e.j;return t[n]&&void 0!==t[n][r]},u=o(n);i(u)&&!e(t[u.i][u.j],u.i,u.j);)u=o(u);if(!i(u)){if(!a)return null;u=r.j<0?{i:u.i-1,j:t[0].length-1}:{i:u.i+1,j:0}}return i(u)&&!e(t[u.i][u.j],u.i,u.j)?this.searchForNextSelectablePos(e,t,u,r,a):i(u)?u:null}},{key:"handleNavigate",value:function(e,t,n){if(t&&(t.i||t.j)){var r=this.props.data,a=this.getState().start,o=e.shiftKey&&!n,i=this.props.isCellNavigable?this.props.isCellNavigable:function(){return!0};if(o)this.updateLocationMultipleCells(t);else{var u=this.searchForNextSelectablePos(i,r,a,t,n);u&&this.updateLocationSingleCell(u)}e.preventDefault()}}},{key:"handleComponentKey",value:function(e){var t=this,n=e.which||e.keyCode;if([h.ENTER_KEY,h.ESCAPE_KEY,h.TAB_KEY].includes(n)){var r=this.state.editing,a=this.props.data;if(!y(r)){var o=a[r.i][r.j],i=e.shiftKey?-1:1;if(o&&o.component&&!o.forceComponent){e.preventDefault();var u=this.onRevert;n===h.ENTER_KEY?u=function(){return t.handleNavigate(e,{i:i,j:0})}:n===h.TAB_KEY&&(u=function(){return t.handleNavigate(e,{i:0,j:i},!0)}),setTimeout(function(){u(),t.dgDom&&t.dgDom.focus({preventScroll:!0})},1)}}}}},{key:"onContextMenu",value:function(e,t,n){var r=this.props.data[t][n];this.props.onContextMenu&&this.props.onContextMenu(e,r,t,n)}},{key:"onDoubleClick",value:function(e,t){this.props.data[e][t].readOnly||this._setState({editing:{i:e,j:t},forceEdit:!0,clear:{}})}},{key:"onMouseDown",value:function(e,t,n){var r=!y(this.state.editing)&&this.state.editing.i===e&&this.state.editing.j===t,a=y(this.state.editing)||this.state.editing.i!==e||this.state.editing.j!==t?{}:this.state.editing;this._setState({selecting:!r,start:n.shiftKey?this.getState().start:{i:e,j:t},end:{i:e,j:t},editing:a,forceEdit:!!r});var o=window.navigator.userAgent;/MSIE|Trident/.test(o)&&document.addEventListener("keydown",this.handleIEClipboardEvents),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousedown",this.pageClick),document.addEventListener("cut",this.handleCut),document.addEventListener("copy",this.handleCopy),document.addEventListener("paste",this.handlePaste)}},{key:"onMouseOver",value:function(e,t){this.state.selecting&&y(this.state.editing)&&this._setState({end:{i:e,j:t}})}},{key:"onMouseUp",value:function(){this._setState({selecting:!1}),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"onChange",value:function(e,t,n){var r=this.props,a=r.onChange,o=r.onCellsChanged,i=r.data;o?o([{cell:i[e][t],row:e,col:t,value:n}]):a&&a(i[e][t],e,t,n),this.onRevert()}},{key:"onRevert",value:function(){var e=this;this._setState({editing:{}}),setTimeout(function(){e.dgDom&&e.dgDom.focus({preventScroll:!0})},1)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,r=n.start,a=n.end,o=t.end;y(a)||a.i===o.i&&a.j===o.j||this.isSelectionControlled()||!this.props.onSelect||this.props.onSelect({start:r,end:a})}},{key:"isSelectedRow",value:function(e){var t=this.getState(),n=t.start,r=t.end,a=n.i,o=r.i;return a<=o?e>=a&&e<=o:e<=a&&e>=o}},{key:"isSelected",value:function(e,t){var n=this.getState(),r=n.start,a=n.end,o=t>=r.j&&t<=a.j,i=t<=r.j&&t>=a.j,u=e>=r.i&&e<=a.i,l=e<=r.i&&e>=a.i;return o&&u||i&&u||i&&l||o&&l}},{key:"isEditing",value:function(e,t){return this.state.editing.i===e&&this.state.editing.j===t}},{key:"isClearing",value:function(e,t){return this.state.clear.i===e&&this.state.clear.j===t}},{key:"render",value:function(){var e=this,t=this.props,n=t.sheetRenderer,a=t.rowRenderer,o=t.cellRenderer,u=t.dataRenderer,l=t.valueRenderer,s=t.dataEditor,d=t.valueViewer,f=t.attributesRenderer,p=t.className,h=t.overflow,v=t.data,y=t.keyFn,b=this.state.forceEdit;return i.default.createElement("span",{ref:function(t){e.dgDom=t},tabIndex:"0",className:"data-grid-container",onKeyDown:this.handleKey},i.default.createElement(n,{data:v,className:["data-grid",p,h].filter(function(e){return e}).join(" ")},v.map(function(t,n){return i.default.createElement(a,{key:y?y(n):n,row:n,cells:t,selected:e.isSelectedRow(n)},t.map(function(t,a){var p=e.isEditing(n,a);return i.default.createElement(c.default,r({key:t.key?t.key:n+"-"+a,row:n,col:a,cell:t,forceEdit:!1,onMouseDown:e.onMouseDown,onMouseOver:e.onMouseOver,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,onChange:e.onChange,onRevert:e.onRevert,onNavigate:e.handleKeyboardCellMovement,onKey:e.handleKey,selected:e.isSelected(n,a),editing:p,clearing:e.isClearing(n,a),attributesRenderer:f,cellRenderer:o,valueRenderer:l,dataRenderer:u,valueViewer:d,dataEditor:s},p?{forceEdit:b}:{}))}))})))}}]),t}(o.PureComponent);t.default=g,g.propTypes={data:u.default.array.isRequired,className:u.default.string,disablePageClick:u.default.bool,overflow:u.default.oneOf(["wrap","nowrap","clip"]),onChange:u.default.func,onCellsChanged:u.default.func,onContextMenu:u.default.func,onSelect:u.default.func,isCellNavigable:u.default.func,selected:u.default.shape({start:u.default.shape({i:u.default.number,j:u.default.number}),end:u.default.shape({i:u.default.number,j:u.default.number})}),valueRenderer:u.default.func.isRequired,dataRenderer:u.default.func,sheetRenderer:u.default.func.isRequired,rowRenderer:u.default.func.isRequired,cellRenderer:u.default.func.isRequired,valueViewer:u.default.func,dataEditor:u.default.func,parsePaste:u.default.func,attributesRenderer:u.default.func,keyFn:u.default.func,handleCopy:u.default.func,editModeChanged:u.default.func},g.defaultProps={sheetRenderer:l.default,rowRenderer:s.default,cellRenderer:d.default,valueViewer:p.default,dataEditor:f.default}},10119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(86006),o=l(a),i=l(n(79497)),u=l(n(69900));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){return o.default.createElement("tr",null,this.props.children)}}]),t}(a.PureComponent);s.propTypes={row:i.default.number.isRequired,cells:i.default.arrayOf(i.default.shape(u.default)).isRequired},t.default=s},11476:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(86006),o=u(a),i=u(n(79497));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){return o.default.createElement("table",{className:this.props.className},o.default.createElement("tbody",null,this.props.children))}}]),t}(a.PureComponent);l.propTypes={className:i.default.string,data:i.default.array.isRequired},t.default=l},40274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(86006),o=l(a),i=l(n(79497)),u=l(n(69900));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){var e=this.props.value;return o.default.createElement("span",{className:"value-viewer"},e)}}]),t}(a.PureComponent);t.default=s,s.propTypes={row:i.default.number.isRequired,col:i.default.number.isRequired,cell:i.default.shape(u.default),value:i.default.node.isRequired}},52815:function(e,t,n){"use strict";var r=d(n(18274)),a=d(n(11476)),o=d(n(10119)),i=d(n(8530)),u=d(n(28344)),l=d(n(40274)),s=n(22748);function d(e){return e&&e.__esModule?e:{default:e}}t.ZP=r.default,a.default,o.default,i.default,u.default,l.default,s.renderValue,s.renderData},43510:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TAB_KEY=9,t.ENTER_KEY=13,t.ESCAPE_KEY=27,t.LEFT_KEY=37,t.UP_KEY=38,t.RIGHT_KEY=39,t.DOWN_KEY=40,t.DELETE_KEY=46,t.BACKSPACE_KEY=8},22748:function(e,t){"use strict";function n(e,t,n,r){var a=r(e,t,n);return null==a?"":a}Object.defineProperty(t,"__esModule",{value:!0}),t.renderValue=n,t.renderData=function(e,t,r,a,o){var i=o?o(e,t,r):null;return null==i?n(e,t,r,a):i}}}]);